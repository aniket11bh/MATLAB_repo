
% Shooting problem 
function J = jacobianreturn(x,y,z,vx,vy,vz)
kpc2km = 30856775814671900;
myr = 1e6*365*86400;

k0 = 0.00287729;
k1 =  0.0023821 ;
k2 = -0.0010625 ;
k3 = 0.000198502 ;
k4 = -1.88428e-05 ;
k5 = 9.70521e-07 ;
k6 = -2.70559e-08; 
k7 = 3.7516e-10 ;
k8 = -1.94316e-12;

J = [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0, 1, 0, 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0, 0, 1, 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0, 0, 0, 1;
 (2*myr^2*x^2)/(kpc2km^2*(x^2 + y^2 + z^2)^2*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^2) - myr^2/(kpc2km^2*(x^2 + y^2 + z^2)*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^2) + (2*myr^2*x*(2*k2*x + 4*k4*x*(x^2 + y^2 + z^2) + (k1*x)/(x^2 + y^2 + z^2)^(1/2) + 3*k3*x*(x^2 + y^2 + z^2)^(1/2) + 6*k6*x*(x^2 + y^2 + z^2)^2 + 5*k5*x*(x^2 + y^2 + z^2)^(3/2) + 8*k8*x*(x^2 + y^2 + z^2)^3 + 7*k7*x*(x^2 + y^2 + z^2)^(5/2)))/(kpc2km^2*(x^2 + y^2 + z^2)*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^3),                                                                                                                                                                                                                                                                   (2*myr^2*x*(2*k2*y + 4*k4*y*(x^2 + y^2 + z^2) + (k1*y)/(x^2 + y^2 + z^2)^(1/2) + 3*k3*y*(x^2 + y^2 + z^2)^(1/2) + 6*k6*y*(x^2 + y^2 + z^2)^2 + 5*k5*y*(x^2 + y^2 + z^2)^(3/2) + 8*k8*y*(x^2 + y^2 + z^2)^3 + 7*k7*y*(x^2 + y^2 + z^2)^(5/2)))/(kpc2km^2*(x^2 + y^2 + z^2)*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^3) + (2*myr^2*x*y)/(kpc2km^2*(x^2 + y^2 + z^2)^2*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^2),                                                                                                                                                                                                                                                                   (2*myr^2*x*(2*k2*z + 4*k4*z*(x^2 + y^2 + z^2) + (k1*z)/(x^2 + y^2 + z^2)^(1/2) + 3*k3*z*(x^2 + y^2 + z^2)^(1/2) + 6*k6*z*(x^2 + y^2 + z^2)^2 + 5*k5*z*(x^2 + y^2 + z^2)^(3/2) + 8*k8*z*(x^2 + y^2 + z^2)^3 + 7*k7*z*(x^2 + y^2 + z^2)^(5/2)))/(kpc2km^2*(x^2 + y^2 + z^2)*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^3) + (2*myr^2*x*z)/(kpc2km^2*(x^2 + y^2 + z^2)^2*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^2), 0, 0, 0;
                                                                                                                                                                                                                                                                   (2*myr^2*y*(2*k2*x + 4*k4*x*(x^2 + y^2 + z^2) + (k1*x)/(x^2 + y^2 + z^2)^(1/2) + 3*k3*x*(x^2 + y^2 + z^2)^(1/2) + 6*k6*x*(x^2 + y^2 + z^2)^2 + 5*k5*x*(x^2 + y^2 + z^2)^(3/2) + 8*k8*x*(x^2 + y^2 + z^2)^3 + 7*k7*x*(x^2 + y^2 + z^2)^(5/2)))/(kpc2km^2*(x^2 + y^2 + z^2)*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^3) + (2*myr^2*x*y)/(kpc2km^2*(x^2 + y^2 + z^2)^2*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^2), (2*myr^2*y^2)/(kpc2km^2*(x^2 + y^2 + z^2)^2*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^2) - myr^2/(kpc2km^2*(x^2 + y^2 + z^2)*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^2) + (2*myr^2*y*(2*k2*y + 4*k4*y*(x^2 + y^2 + z^2) + (k1*y)/(x^2 + y^2 + z^2)^(1/2) + 3*k3*y*(x^2 + y^2 + z^2)^(1/2) + 6*k6*y*(x^2 + y^2 + z^2)^2 + 5*k5*y*(x^2 + y^2 + z^2)^(3/2) + 8*k8*y*(x^2 + y^2 + z^2)^3 + 7*k7*y*(x^2 + y^2 + z^2)^(5/2)))/(kpc2km^2*(x^2 + y^2 + z^2)*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^3),                                                                                                                                                                                                                                                                   (2*myr^2*y*(2*k2*z + 4*k4*z*(x^2 + y^2 + z^2) + (k1*z)/(x^2 + y^2 + z^2)^(1/2) + 3*k3*z*(x^2 + y^2 + z^2)^(1/2) + 6*k6*z*(x^2 + y^2 + z^2)^2 + 5*k5*z*(x^2 + y^2 + z^2)^(3/2) + 8*k8*z*(x^2 + y^2 + z^2)^3 + 7*k7*z*(x^2 + y^2 + z^2)^(5/2)))/(kpc2km^2*(x^2 + y^2 + z^2)*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^3) + (2*myr^2*y*z)/(kpc2km^2*(x^2 + y^2 + z^2)^2*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^2), 0, 0, 0;
                                                                                                                                                                                                                                                                   (2*myr^2*z*(2*k2*x + 4*k4*x*(x^2 + y^2 + z^2) + (k1*x)/(x^2 + y^2 + z^2)^(1/2) + 3*k3*x*(x^2 + y^2 + z^2)^(1/2) + 6*k6*x*(x^2 + y^2 + z^2)^2 + 5*k5*x*(x^2 + y^2 + z^2)^(3/2) + 8*k8*x*(x^2 + y^2 + z^2)^3 + 7*k7*x*(x^2 + y^2 + z^2)^(5/2)))/(kpc2km^2*(x^2 + y^2 + z^2)*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^3) + (2*myr^2*x*z)/(kpc2km^2*(x^2 + y^2 + z^2)^2*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^2),                                                                                                                                                                                                                                                                   (2*myr^2*z*(2*k2*y + 4*k4*y*(x^2 + y^2 + z^2) + (k1*y)/(x^2 + y^2 + z^2)^(1/2) + 3*k3*y*(x^2 + y^2 + z^2)^(1/2) + 6*k6*y*(x^2 + y^2 + z^2)^2 + 5*k5*y*(x^2 + y^2 + z^2)^(3/2) + 8*k8*y*(x^2 + y^2 + z^2)^3 + 7*k7*y*(x^2 + y^2 + z^2)^(5/2)))/(kpc2km^2*(x^2 + y^2 + z^2)*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^3) + (2*myr^2*y*z)/(kpc2km^2*(x^2 + y^2 + z^2)^2*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^2), (2*myr^2*z^2)/(kpc2km^2*(x^2 + y^2 + z^2)^2*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^2) - myr^2/(kpc2km^2*(x^2 + y^2 + z^2)*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^2) + (2*myr^2*z*(2*k2*z + 4*k4*z*(x^2 + y^2 + z^2) + (k1*z)/(x^2 + y^2 + z^2)^(1/2) + 3*k3*z*(x^2 + y^2 + z^2)^(1/2) + 6*k6*z*(x^2 + y^2 + z^2)^2 + 5*k5*z*(x^2 + y^2 + z^2)^(3/2) + 8*k8*z*(x^2 + y^2 + z^2)^3 + 7*k7*z*(x^2 + y^2 + z^2)^(5/2)))/(kpc2km^2*(x^2 + y^2 + z^2)*(k0 + k1*(x^2 + y^2 + z^2)^(1/2) + k4*(x^2 + y^2 + z^2)^2 + k3*(x^2 + y^2 + z^2)^(3/2) + k6*(x^2 + y^2 + z^2)^3 + k5*(x^2 + y^2 + z^2)^(5/2) + k8*(x^2 + y^2 + z^2)^4 + k7*(x^2 + y^2 + z^2)^(7/2) + k2*(x^2 + y^2 + z^2))^3), 0, 0, 0];
